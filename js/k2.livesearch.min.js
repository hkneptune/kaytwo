function LiveSearch(a){var b=this;jQuery("body").addClass("livesearch");this.searchPrompt=a;this.searchform=jQuery("#searchform");this.searchField=jQuery("#s");this.reset=jQuery("#searchreset");this.loading=jQuery("#searchload");this.searchLabel=jQuery("#search-label");jQuery("#searchsubmit").addClass("hidden");this.searchLabel.empty().text(a).addClass("overlabel-apply");this.searchField.focus(function(){b.searchLabel.addClass("fade")}).blur(function(){if(b.searchField.val()==""){b.searchLabel.show().removeClass("fade");
if(b.prevSearch!=""){b.resetSearch(b)}}}).keydown(function(d){if(b.searchField.val()==""){b.searchLabel.show();if(b.prevSearch!=null){b.resetSearch(b)}}var c=d.keyCode;if(c==27){b.resetSearch(b)}else{if(c!=13&&c!=9){b.searchLabel.addClass("hide");if(b.timer){clearTimeout(b.timer)}b.timer=setTimeout(function(){b.doSearch(b)},1000)}}}).keyup(function(d){var c=d.keyCode;if(c!=13){if(b.searchField.val()==""){b.resetSearch(b);clearTimeout(b.timer)}else{b.reset.fadeTo("fast",0);b.loading.fadeTo("fast",1)
}}});if(this.searchField.val()!=""){this.doSearch(b);this.searchLabel.addClass("hide")}b.loading.fadeTo("fast",0);b.reset.fadeTo("fast",0)}LiveSearch.prototype.doSearch=function(a){if(a.searchField.val()==a.prevSearch){return}if(a.prevSearch&&(a.searchField.val()!=a.prevSearch)){jQuery.bbq.removeState("page")}if(a.searchField.val()==""){a.searchField.val(jQuery.deparam.fragment().search);a.searchLabel.addClass("hide")}if(!a.active){a.active=true;jQuery("body").removeClass("livesearchinactive").addClass("livesearchactive");
if(K2.RollingArchives.saveState){K2.RollingArchives.saveState()}}a.prevSearch=a.searchField.val();if(K2.Animations&&a.pageNumber!=1&&jQuery("body").hasClass("smartposition")){jQuery("html,body").animate({scrollTop:jQuery(".primary").offset().top},100)}jQuery.bbq.pushState("search="+a.searchField.val());K2.ajaxGet(a.searchform.serialize()+"&k2dynamic=init",function(b){jQuery(".content").html(b);a.loading.fadeTo("fast",0)});a.reset.click(function(){a.resetSearch(a)}).fadeTo("fast",1).css("cursor","pointer")
};LiveSearch.prototype.resetSearch=function(a){a.reset.unbind("click").fadeTo("fast",0).css("cursor","default");delete K2.RollingArchives.query.s;a.active=false;a.prevSearch="";a.searchField.val("");a.searchLabel.removeClass("hide");a.loading.fadeTo("fast",0);var b=jQuery(window).scrollTop();jQuery.bbq.removeState("search");jQuery(window).scrollTop(b);if(K2.RollingArchives.restoreState){K2.RollingArchives.restoreState()}};